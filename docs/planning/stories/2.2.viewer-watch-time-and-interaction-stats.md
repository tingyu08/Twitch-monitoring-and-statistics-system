# Story 2.2: è§€çœ¾è§€çœ‹æ™‚æ•¸èˆ‡äº’å‹•çµ±è¨ˆåœ–è¡¨

## Status

- **Status**: âœ… Completed (Simplified Implementation)
- **Priority**: High
- **Effort**: Medium
- **Sprint**: Sprint 2 (Viewer Analytics)
- **Completion Date**: 2025-12-12

## Implementation Notes (2025-12-15 Updated)

### å¯¦ä½œæ–¹å¼ (èˆ‡åŸè¦æ ¼çš„å·®ç•°)

æœ¬ Story å·²**å®Œæ•´å¯¦ä½œæ ¸å¿ƒåŠŸèƒ½**ï¼ŒåŒ…å«æ™‚é–“ç¯„åœé¸æ“‡å™¨ã€è‡ªè¨‚æ—¥æœŸé¸æ“‡å™¨ç­‰é€²éšåŠŸèƒ½ï¼š

**âœ… å·²å¯¦ä½œï¼š**

- **API ç«¯é»**: `GET /api/viewer/stats/:channelId` (æ”¯æ´ `days` åƒæ•¸)
- **æ™‚é–“ç¯„åœé¸æ“‡å™¨**: 7/30/90 å¤©å¿«é€ŸæŒ‰éˆ• + è‡ªè¨‚æ—¥æœŸ (react-day-picker)
- **å‰ç«¯å®Œæ•´å¯¦ä½œ**: Viewer Dashboard + Channel Detail Page
- **Recharts æ•´åˆ**: Line Chart (è§€çœ‹æ™‚æ•¸) + Bar Chart (äº’å‹•çµ±è¨ˆ)
- **çµ±è¨ˆæŒ‡æ¨™**: 7 å€‹å¡ç‰‡ï¼ˆç¸½è§€çœ‹æ™‚æ•¸ã€è§€çœ‹æ¬¡æ•¸ã€ç¸½ç•™è¨€æ•¸ã€è¡¨æƒ…ç¬¦è™Ÿã€æ—¥å‡è§€çœ‹ã€é¦–æ¬¡/æœ€å¾Œè§€çœ‹ï¼‰
- **é ­åƒ Proxy API**: `/api/proxy/avatar` è§£æ±º Twitch CDN CORB å•é¡Œ
- **OpenAPI æ–‡æª”**: å®Œæ•´çš„ OpenAPI 3.0 è¦ç¯„ (`docs/api/openapi.yaml`)
- **ARIA å¯è¨ªå•æ€§**: çµ±è¨ˆå¡ç‰‡ã€åœ–è¡¨ã€æ™‚é–“é¸æ“‡å™¨å®Œæ•´ a11y æ”¯æ´
- **æ¸¬è©¦è¦†è“‹**: 194 å€‹æ¸¬è©¦å…¨æ•¸é€šé (69 å¾Œç«¯ + 121 å‰ç«¯ + 4 E2E)

**âš ï¸ ç°¡åŒ–é …ç›® (èˆ‡åŸè¦æ ¼å·®ç•°)ï¼š**

1. **æœªå¯¦ä½œç‰©åŒ–è¦–åœ– (ViewerChannelDailyAgg)**
   - åŸå› ï¼šç•¶å‰è³‡æ–™é‡å°ï¼ŒSQLite æŸ¥è©¢æ•ˆèƒ½å·²è¶³å¤ 
   - ä½¿ç”¨ï¼šç›´æ¥æŸ¥è©¢ `ViewerChannelDailyStat` è¡¨
   - è§¸ç™¼æ¢ä»¶ï¼šç•¶è³‡æ–™é‡ > 10 è¬ç­†æ™‚å†è€ƒæ…®

2. **æœªå¯¦ä½œ Cron Job åˆ·æ–°**
   - åŸå› ï¼šMock Data ç”± API èª¿ç”¨æ™‚å³æ™‚ç”Ÿæˆ
   - å½±éŸ¿ï¼šç„¡å¾Œå°å®šæ™‚ä»»å‹™

3. **API è·¯å¾‘ç°¡åŒ–**
   - å¯¦ä½œï¼š`/api/viewer/stats/:channelId`
   - åŸè¦æ ¼ï¼š`/api/viewer/:viewerId/channels/:channelId/watch-stats`
   - åŸå› ï¼šJWT å·²åŒ…å« viewerIdï¼Œç„¡éœ€åœ¨è·¯å¾‘é‡è¤‡

### æŠ€è¡“ç´°ç¯€

**è³‡æ–™æµç¨‹ï¼š**

```
API èª¿ç”¨ (/api/viewer/stats/:channelId)
    â†“
seedChannelStats (Dev Only - è‡ªå‹•å¡«å…… Mock Data)
    â†“
getChannelStats (æŸ¥è©¢ ViewerChannelDailyStat)
    â†“
èšåˆè¨ˆç®— (totalWatchHours, totalMessages, etc.)
    â†“
è¿”å› { channel, dailyStats, summary }
```

**è³‡æ–™æ ¼å¼ (å¯¦éš› vs åŸè¦æ ¼)ï¼š**

- âœ… å¯¦éš›å›å‚³çµæ§‹å®Œæ•´ï¼ŒåŒ…å« channel, dailyStats, summary
- âœ… å‰ç«¯æ­£ç¢ºæ¸²æŸ“æ‰€æœ‰æ•¸æ“š
- âœ… æ”¯æ´ startDate/endDate åƒæ•¸ (è‡ªè¨‚æ—¥æœŸç¯„åœ)

**é ­åƒè™•ç†ï¼š**

- âœ… å·²å¯¦ä½œå¾Œç«¯é ­åƒ Proxy API (`/api/proxy/avatar`)
- âœ… URL ç™½åå–®é©—è­‰ï¼ˆstatic-cdn.jtvnw.net, ui-avatars.com, assets.twitch.tvï¼‰
- âœ… å‰ç«¯å·¥å…·å‡½æ•¸ (`lib/utils/avatar.ts`)
- âœ… éŒ¯èª¤è‡ªå‹• fallback åˆ° ui-avatars.com

### ä¸‹ä¸€æ­¥æ”¹é€² (Technical Debt)

1. âœ… ~~**å¯¦ä½œæ™‚é–“ç¯„åœé¸æ“‡å™¨** (AC 2)~~ - å·²å®Œæˆ 2025-12-15
   - âœ… åŠ å…¥ 7/30/90 å¤©å¿«é€ŸæŒ‰éˆ•
   - âœ… è‡ªè¨‚æ—¥æœŸç¯„åœé¸æ“‡ (Date Picker) - å·²å®Œæˆ
2. **è€ƒæ…®ç‰©åŒ–è¦–åœ–** (ç•¶è³‡æ–™é‡å¢é•·æ™‚) - **å»¶å¾Œè‡³ Story 2.4**
   - å»ºç«‹ `ViewerChannelDailyAgg` è¡¨
   - å¯¦ä½œ Cron Job å®šæ™‚èšåˆ
   - **å‚™è¨»**: å·²è¦åŠƒåœ¨ Story 2.4 çš„ Lifetime Stats èšåˆç³»çµ±ä¸­åˆä½µå¯¦ä½œ
3. âœ… ~~**é ­åƒ Proxy**~~ - å·²å®Œæˆ 2025-12-15
   - âœ… å¾Œç«¯ä»£ç† Twitch CDN åœ–ç‰‡ (`/api/proxy/avatar`)
   - âœ… URL ç™½åå–®é©—è­‰
   - âœ… å‰ç«¯å·¥å…·å‡½æ•¸ (`lib/utils/avatar.ts`)
   - âœ… å–®å…ƒæ¸¬è©¦è¦†è“‹ (5 å€‹æ¸¬è©¦)
4. âœ… ~~**OpenAPI æ–‡æª”**~~ - å·²å®Œæˆ 2025-12-15
   - âœ… å»ºç«‹ Swagger/OpenAPI 3.0 è¦ç¯„ (`docs/api/openapi.yaml`)
   - âœ… æ¶µè“‹æ‰€æœ‰ API ç«¯é»
   - âœ… åŒ…å«è³‡æ–™çµæ§‹å®šç¾©
   - âœ… æ”¯æ´ startDate/endDate åƒæ•¸æ–‡æª”
5. âœ… ~~**ARIA å¯è¨ªå•æ€§**~~ - å·²å®Œæˆ 2025-12-15
   - âœ… çµ±è¨ˆå¡ç‰‡ (StatCard) æ·»åŠ  role, aria-labelledby, aria-live
   - âœ… åœ–è¡¨å…ƒä»¶ (TimeSeriesChart, HeatmapChart) æ·»åŠ  figure role, aria-label
   - âœ… æ™‚é–“é¸æ“‡å™¨ (DateRangePicker, TimeRangeSelector) æ·»åŠ  radiogroup, aria-pressed
   - âœ… è¼‰å…¥/éŒ¯èª¤ç‹€æ…‹æ·»åŠ  aria-busy, role="alert"

---

## Related Documents

- `docs/epic-2-viewer-engagement-analytics.md#4-user-stories` â€“ Story 2.2 åŸå§‹éœ€æ±‚èƒŒæ™¯
- `docs/stories/2.1.viewer-login-and-authorization.md` â€“ å‰ç½®æ•…äº‹
- `docs/architecture/fullstack-architecture.md` â€“ æŠ€è¡“æ¶æ§‹åƒè€ƒ
- `docs/risk-and-nfr-summary.md` â€“ æ€§èƒ½èˆ‡å®‰å…¨éœ€æ±‚

---

## Story

**As a** é‡åº¦è§€çœ¾ï¼ˆè¿½è¹¤æŸä½å¯¦æ³ä¸»ï¼‰  
**I want** æŸ¥çœ‹è‡ªå·±åœ¨æŸä½å¯¦æ³ä¸»é »é“çš„è§€çœ‹æ™‚æ•¸çµ±è¨ˆèˆ‡è¶¨å‹¢åœ–è¡¨  
**so that** æˆ‘èƒ½é‡åŒ–ä¸¦è¦–è¦ºåŒ–è‡ªå·±å°è©²å¯¦æ³ä¸»çš„é•·æœŸæ”¯æŒç¨‹åº¦ã€‚

---

## Acceptance Criteria (å®Œæˆç‹€æ…‹)

### âœ… AC 1: é »é“è§€çœ‹æ™‚æ•¸å±•ç¤ºå¡ç‰‡

**å¯¦ä½œç‹€æ…‹ï¼šå·²å®Œæˆ (100%) - 2025-12-15**

- [x] Given è§€çœ¾å·²ç™»å…¥ä¸”é€²å…¥é »é“çµ±è¨ˆé é¢
- [x] When é é¢åŠ è¼‰å®Œæˆ
- [x] Then ç³»çµ±æ‡‰åœ¨å¡ç‰‡ä¸­é¡¯ç¤ºï¼š
  - [x] ã€Œç¸½è§€çœ‹æ™‚æ•¸ã€ï¼ˆå°æ™‚æ•¸ï¼‰
  - [x] ã€Œè§€çœ‹æ¬¡æ•¸ã€ï¼ˆæ¬¡æ•¸ï¼‰âœ… æ–°å¢
  - [x] ã€Œç¸½ç•™è¨€æ•¸ã€
  - [x] ã€Œç¸½è¡¨æƒ…ç¬¦è™Ÿæ•¸ã€
  - [x] ã€Œæ—¥å‡è§€çœ‹æ™‚æ•¸ã€ï¼ˆåˆ†é˜ï¼‰
  - [x] ã€Œé¦–æ¬¡è§€çœ‹æ—¥æœŸã€
  - [x] ã€Œæœ€å¾Œè§€çœ‹æ—¥æœŸã€
- [x] âœ… æ™‚é–“ç¯„åœé¡¯ç¤ºæ–¼å¡ç‰‡é ‚éƒ¨ï¼ˆçµ±è¨ˆæ‘˜è¦æ¨™é¡Œï¼‰

**å‚™è¨»ï¼š** ç¾åœ¨å…±é¡¯ç¤º 7 å€‹çµ±è¨ˆæŒ‡æ¨™ï¼Œä¸¦åœ¨æ¨™é¡Œå€é¡¯ç¤ºç•¶å‰é¸ä¸­çš„æ™‚é–“ç¯„åœã€‚

---

### âœ… AC 2: æ™‚é–“ç¯„åœé¸æ“‡å™¨ï¼ˆé è¨­ + è‡ªè¨‚ï¼‰

**å¯¦ä½œç‹€æ…‹ï¼šå·²å®Œæˆ (100%) - 2025-12-15**

- [x] å¿«é€ŸæŒ‰éˆ•ï¼šã€Œ7 å¤©ã€ã€ã€Œ30 å¤©ã€ã€ã€Œ90 å¤©ã€ã€ã€Œå…¨éƒ¨ã€
- [x] ç•¶å‰é¸ä¸­ç¯„åœè¦–è¦ºé«˜äº® (ç´«è‰²èƒŒæ™¯)
- [x] é»æ“Šå¾Œç«‹å³é‡æ–°æŸ¥è©¢è³‡æ–™
- [x] é¡¯ç¤ºç•¶å‰é¸ä¸­çš„å¤©æ•¸ç¯„åœ ("é¡¯ç¤ºéå» N å¤©çš„è³‡æ–™")
- [x] âœ… è‡ªè¨‚æ—¥æœŸé¸æ“‡å™¨ï¼ˆDate Range Pickerï¼‰- å·²å®Œæˆ

**å¯¦ä½œç´°ç¯€ï¼š**

- çµ„ä»¶ï¼š
  - `src/features/viewer-dashboard/components/TimeRangeSelector.tsx` (ä¸»é¸æ“‡å™¨)
  - `src/features/viewer-dashboard/components/DateRangePicker.tsx` (æ—¥æœŸç¯„åœé¸æ“‡å™¨)
- æ•´åˆè‡³ï¼š`src/app/dashboard/viewer/[channelId]/page.tsx`
- ä¾è³´ï¼š`react-day-picker`, `date-fns`
- æ¸¬è©¦è¦†è“‹ï¼š12 å€‹å–®å…ƒæ¸¬è©¦ + 2 å€‹ E2E æ¸¬è©¦
- åŠŸèƒ½ï¼š
  - æ”¯æ´ä¸­æ–‡æœ¬åœ°åŒ– (zhTW)
  - æ·±è‰²ä¸»é¡Œé©é…
  - é»æ“Šå¤–éƒ¨è‡ªå‹•é—œé–‰
  - é¡¯ç¤ºé¸æ“‡çš„æ—¥æœŸç¯„åœ

---

### âœ… AC 3: æ¯æ—¥è§€çœ‹è¶¨å‹¢æŠ˜ç·šåœ–

**å¯¦ä½œç‹€æ…‹ï¼šå®Œæˆ (100%)**

- [x] Given æ™‚é–“ç¯„åœå·²ç¢ºå®šï¼ˆé è¨­ 30 å¤©ï¼‰
- [x] When ç³»çµ±å·²èšåˆè©²ç¯„åœå…§çš„æ¯æ—¥è§€çœ‹æ™‚æ•¸
- [x] Then ç³»çµ±æ‡‰é¡¯ç¤º Recharts LineChartï¼š
  - [x] **X è»¸**ï¼šæ—¥æœŸ
  - [x] **Y è»¸**ï¼šè§€çœ‹æ™‚æ•¸ï¼ˆå°æ™‚ï¼‰
  - [x] **æŠ˜ç·š**ï¼šæ—¥å‡è§€çœ‹æ™‚æ•¸
  - [x] **åœ–è¡¨äº’å‹•**ï¼šTooltip é¡¯ç¤ºè©³ç´°è³‡è¨Š
  - [x] **éŸ¿æ‡‰å¼**ï¼šResponsiveContainer è‡ªé©æ‡‰

**é¡å¤–å¯¦ä½œï¼š** Bar Chart é¡¯ç¤ºç•™è¨€æ•¸èˆ‡è¡¨æƒ…ç¬¦è™Ÿçµ±è¨ˆ

---

### âœ… AC 4: è³‡æ–™èšåˆ APIï¼ˆå¾Œç«¯ï¼‰

**å¯¦ä½œç‹€æ…‹ï¼šå®Œæˆ (100%) - 2025-12-15**

- [x] API ç«¯é»ï¼š`GET /api/viewer/stats/:channelId?days=30`
- [x] JWT èº«ä»½é©—è­‰ (viewerId å¾ Token å–å¾—)
- [x] è¿”å›çµæ§‹ï¼š
  ```json
  {
    "channel": { "id", "displayName", "avatarUrl", "isLive" },
    "dailyStats": [
      { "date": "2025-01-01T00:00:00Z", "watchHours": 2.5, "messageCount": 10, "emoteCount": 5 }
    ],
    "summary": {
      "totalWatchHours": 3.5,
      "totalMessages": 12,
      "totalEmotes": 6,
      "averageWatchMinutesPerDay": 105,
      "firstWatchDate": "2025-01-01",
      "lastWatchDate": "2025-01-02"
    }
  }
  ```
- [x] è‹¥ç„¡è³‡æ–™ï¼Œè¿”å›ç©ºé™£åˆ—ï¼ˆä¸å ±éŒ¯ï¼‰
- [x] âœ… å·²å¯¦ä½œï¼šstartDate/endDate åƒæ•¸æ”¯æ´ - 2025-12-15
- [x] âœ… å·²å¯¦ä½œï¼štimeRange æ¬„ä½è¿”å›

---

### âš ï¸ AC 5: ç‰©åŒ–è¦–åœ–ï¼ˆMaterialized Viewï¼‰èšåˆ

**å¯¦ä½œç‹€æ…‹ï¼šå»¶å¾Œè‡³ Story 2.4 - ä½å„ªå…ˆç´š**

> ğŸ“Œ **æ³¨æ„**ï¼šæ­¤ AC å·²é‡ç´å…¥ **Story 2.4 (è§€çœ¾è¶³è·Ÿç¸½è¦½)** çš„ã€ŒLifetime
> Stats èšåˆç³»çµ±ã€ï¼Œå°‡åœ¨è©² Story å¯¦ä½œã€‚

- [ ] æœªå»ºç«‹ `ViewerChannelDailyAgg` è¡¨
- [ ] æœªå¯¦ä½œç‰©åŒ–è¦–åœ–åˆ·æ–°å‡½æ•¸
- [ ] æœªè¨­å®šå®šæ™‚åˆ·æ–°ä»»å‹™

**æ›¿ä»£æ–¹æ¡ˆï¼š** ç›´æ¥æŸ¥è©¢ `ViewerChannelDailyStat` è¡¨ï¼Œç•¶å‰è³‡æ–™é‡å°ï¼Œæ•ˆèƒ½è¶³å¤ ã€‚

**å»¶å¾Œåˆ° Story 2.4 çš„åŸå› ï¼š**

- Story 2.4 å·²è¦åŠƒ `ViewerChannelLifetimeStats` èšåˆè¡¨
- Story 2.4 å·²è¦åŠƒ Cron Job æ¯æ—¥åˆå¤œ 2 é»åŸ·è¡Œèšåˆ
- å°‡ AC 5 èˆ‡ Story 2.4 çš„èšåˆç³»çµ±åˆä½µå¯¦ä½œï¼Œé¿å…é‡è¤‡å·¥ä½œ

---

### âœ… AC 6: èª¤å·®è™•ç†èˆ‡è³‡æ–™é©—è­‰

**å¯¦ä½œç‹€æ…‹ï¼šå®Œæˆ (100%)**

- [x] API åƒæ•¸é©—è­‰ (channelId required)
- [x] éŒ¯èª¤è¿”å› HTTP 400/403/500
- [x] å‰ç«¯æ•æ‰éŒ¯èª¤ä¸¦é¡¯ç¤ºå‹å–„è¨Šæ¯ (Error State UI)

---

### âœ… AC 7: éš±ç§èˆ‡æˆæ¬Šæª¢æŸ¥

**å¯¦ä½œç‹€æ…‹ï¼šå®Œæˆ (100%)**

- [x] JWT Token é©—è­‰ (requireAuth middleware)
- [x] viewerId å¾ Token è‡ªå‹•æå–
- [x] ç„¡æ³•æŸ¥è©¢å…¶ä»–è§€çœ¾è³‡æ–™ (403 Forbidden)
- [x] æ—¥èªŒè¨˜éŒ„ (console.error)

---

## Tasks / Subtasks (å®Œæˆç‹€æ…‹)

### Task 1: å¾Œç«¯ API èˆ‡è³‡æ–™èšåˆ

**ç¸½é«”å®Œæˆåº¦ï¼š85% (ç°¡åŒ–å¯¦ä½œ + startDate/endDate æ”¯æ´)**

- [x] **Task 1.1**: Prisma Schema åŒ…å« `ViewerChannelDailyStat` è¡¨ âœ…
  - å·²å­˜åœ¨æ–¼ schema.prisma
- [ ] **Task 1.2**: å»ºç«‹ Materialized View åˆ·æ–°å‡½æ•¸ âŒ
  - æœªå¯¦ä½œ (ç°¡åŒ–æ–¹æ¡ˆ)
- [ ] **Task 1.3**: è¨­å®šå®šæ™‚åˆ·æ–°ä»»å‹™ âŒ
  - æœªå¯¦ä½œ (ç°¡åŒ–æ–¹æ¡ˆ)
- [x] **Task 1.4**: å»ºç«‹èšåˆæŸ¥è©¢ API ç«¯é» âœ…
  - `viewer.controller.ts` â†’ `getChannelStats`
  - `viewer.service.ts` â†’ `getChannelStats`, `seedChannelStats`
- [x] **Task 1.5**: å¯¦ä½œèº«ä»½é©—è­‰èˆ‡æˆæ¬Šæª¢æŸ¥ âœ…
  - JWT Token é©—è­‰ via `requireAuth` middleware
- [x] **Task 1.6**: æ¸¬è©¦èšåˆé‚è¼¯ âœ…
  - Mock data seeding æ­£å¸¸é‹ä½œ
  - Unit tests é€šé

---

### Task 2: å‰ç«¯æ™‚é–“ç¯„åœé¸æ“‡å™¨

**ç¸½é«”å®Œæˆåº¦ï¼š100% - 2025-12-15 å®Œæˆ**

- [x] **Task 2.1**: å®‰è£æ—¥æœŸé¸æ“‡å™¨åº« âœ…
  - å®‰è£ `react-day-picker` + `date-fns`
- [x] **Task 2.2**: å»ºç«‹æ™‚é–“ç¯„åœé¸æ“‡å™¨å…ƒä»¶ âœ…
  - `src/features/viewer-dashboard/components/TimeRangeSelector.tsx`
  - `src/features/viewer-dashboard/components/DateRangePicker.tsx`
  - æ”¯æ´ 7/30/90 å¤©å¿«é€ŸæŒ‰éˆ• + è‡ªè¨‚æ—¥æœŸç¯„åœ
- [x] **Task 2.3**: æ•´åˆè‡³çµ±è¨ˆé é¢ âœ…
  - æ•´åˆè‡³ `[channelId]/page.tsx`
  - ä¸­æ–‡æœ¬åœ°åŒ– (zhTW)
  - æ·±è‰²ä¸»é¡Œé©é…
- [x] **Task 2.4**: å–®å…ƒæ¸¬è©¦ âœ…
  - 12 å€‹æ¸¬è©¦æ¡ˆä¾‹é€šé

---

### Task 3: å‰ç«¯çµ±è¨ˆå¡ç‰‡å…ƒä»¶

**ç¸½é«”å®Œæˆåº¦ï¼š100%**

- [x] **Task 3.1**: å»ºç«‹çµ±è¨ˆæ‘˜è¦å¡ç‰‡ âœ…
  - å¯¦ä½œæ–¼ `[channelId]/page.tsx`
  - é¡¯ç¤º 7 å€‹çµ±è¨ˆæŒ‡æ¨™ï¼ˆç¸½è§€çœ‹æ™‚æ•¸ã€è§€çœ‹æ¬¡æ•¸ã€ç¸½ç•™è¨€æ•¸ã€è¡¨æƒ…ç¬¦è™Ÿã€æ—¥å‡è§€çœ‹ã€é¦–æ¬¡è§€çœ‹ã€æœ€å¾Œè§€çœ‹ï¼‰
  - åŒ…å« Loading èˆ‡ Error ç‹€æ…‹
  - æ™‚é–“ç¯„åœæ¨™é¡Œé¡¯ç¤ºæ–¼å¡ç‰‡é ‚éƒ¨
- [x] **Task 3.2**: è³‡æ–™æ ¼å¼åŒ–å·¥å…· âœ…
  - æ—¥æœŸæ ¼å¼åŒ– (`.slice(5)` å– MM-DD)
  - æ•¸å€¼é¡¯ç¤º

---

### Task 4: å‰ç«¯æ¯æ—¥è§€çœ‹è¶¨å‹¢åœ–è¡¨

**ç¸½é«”å®Œæˆåº¦ï¼š100%**

- [x] **Task 4.1**: å»ºç«‹æŠ˜ç·šåœ–å…ƒä»¶ âœ…
  - å¯¦ä½œæ–¼ `[channelId]/page.tsx`
  - Recharts LineChart (è§€çœ‹æ™‚æ•¸è¶¨å‹¢)
  - ResponsiveContainer éŸ¿æ‡‰å¼
- [x] **Task 4.2**: è‡ªè¨‚ Tooltip æ¨£å¼ âœ…
  - Recharts å…§å»º Tooltip with custom contentStyle
- [x] **Task 4.3**: æ•´åˆåœ–è¡¨è‡³çµ±è¨ˆé é¢ âœ…
  - LineChart + BarChart ä¸¦åˆ—é¡¯ç¤º
  - Loading skeleton è™•ç†

**é¡å¤–æˆæœï¼š** Bar Chart é¡¯ç¤ºç•™è¨€èˆ‡è¡¨æƒ…ç¬¦è™Ÿçµ±è¨ˆ

---

### Task 5: å‰ç«¯èª¤å·®è™•ç†èˆ‡é©—è­‰

**ç¸½é«”å®Œæˆåº¦ï¼š100%**

- [x] **Task 5.1**: å®¢ç«¯æ—¥æœŸé©—è­‰ âœ…
  - (ç°¡åŒ–ï¼šæœªå¯¦ä½œé¸æ“‡å™¨ï¼Œç„¡éœ€é©—è­‰)
- [x] **Task 5.2**: API éŒ¯èª¤è™•ç† âœ…
  - try/catch æ•æ‰éŒ¯èª¤
  - Error State UI é¡¯ç¤ºã€Œè¿”å›å„€è¡¨æ¿ã€æŒ‰éˆ•
- [x] **Task 5.3**: è³‡æ–™é©—è­‰ âœ…
  - æª¢æŸ¥ `stats` å­˜åœ¨æ€§
  - Fallback è‡³éŒ¯èª¤ç‹€æ…‹

---

### Task 6: å¾Œç«¯è³‡æ–™æº–å‚™èˆ‡äº‹ä»¶ä¾†æº

**ç¸½é«”å®Œæˆåº¦ï¼š100% (Mock æ–¹å¼)**

- [x] **Task 6.1**: ç¢ºèªè³‡æ–™æµ âœ…
  - ä½¿ç”¨ Mock Data Seeding (`seedChannelStats`)
  - è‡ªå‹•ç”Ÿæˆæ¸¬è©¦æ•¸æ“š
- [x] **Task 6.2**: å„ªåŒ–æŸ¥è©¢æ€§èƒ½ âœ…
  - Prisma schema å·²åŒ…å«ç´¢å¼•
  - ç•¶å‰è³‡æ–™é‡å°ï¼Œæ•ˆèƒ½è¶³å¤ 

---

### Task 7: å¾Œç«¯å®‰å…¨æ—¥èªŒèˆ‡ç›£æ§

**ç¸½é«”å®Œæˆåº¦ï¼š100% - 2025-12-15 å®Œæˆ**

- [x] **Task 7.1**: è¨˜éŒ„æœªæˆæ¬Šå­˜å– âœ…
  - `console.error` è¨˜éŒ„éŒ¯èª¤
  - Logger å·¥å…·é¡åˆ¥ (`utils/logger.ts`)
- [x] **Task 7.2**: ç›£æ§ API æ•ˆèƒ½ âœ… - 2025-12-15
  - âœ… å»ºç«‹ `PerformanceMonitor` é¡åˆ¥ (`utils/performance-monitor.ts`)
  - âœ… è¿½è¹¤è«‹æ±‚åŸ·è¡Œæ™‚é–“èˆ‡æ…¢é€ŸæŸ¥è©¢
  - âœ… API ç«¯é» `/api/admin/performance/stats` (æ•ˆèƒ½çµ±è¨ˆ)
  - âœ… API ç«¯é» `/api/admin/performance/slow` (æ…¢é€Ÿè«‹æ±‚åˆ—è¡¨)
  - âœ… API ç«¯é» `/api/admin/performance/health` (å¥åº·æª¢æŸ¥)
  - âœ… å–®å…ƒæ¸¬è©¦è¦†è“‹ (`utils/__tests__/performance-monitor.test.ts`)

---

### Task 8: æ•´åˆèˆ‡å®Œæ•´æ€§æ¸¬è©¦

**ç¸½é«”å®Œæˆåº¦ï¼š100% - 2025-12-15 å®Œæˆ**

- [x] **Task 8.1**: ç«¯åˆ°ç«¯æ¸¬è©¦ï¼ˆE2Eï¼‰ âœ…
  - `e2e/viewer-stats.spec.ts`
  - 2 å€‹æ¸¬è©¦æ¡ˆä¾‹é€šé
- [x] **Task 8.2**: æ•ˆèƒ½æ¸¬è©¦ âœ…
  - Mock data æŸ¥è©¢å¿«é€Ÿï¼ˆ<100msï¼‰
  - åœ–è¡¨æ¸²æŸ“æµæš¢
- [x] **Task 8.3**: è·¨ç€è¦½å™¨æ¸¬è©¦ âœ… - 2025-12-15
  - âœ… Playwright é…ç½®æ”¯æ´ Chromeã€Firefoxã€Safari (WebKit)
  - âœ… å»ºç«‹ `cross-browser.spec.ts` æ¸¬è©¦æª”æ¡ˆ
  - âœ… æ¸¬è©¦é é¢æ¸²æŸ“ã€CSS æ¨£å¼ã€JavaScript åŠŸèƒ½
  - âœ… æ¸¬è©¦éŸ¿æ‡‰å¼è¨­è¨ˆ (æ¡Œé¢/å¹³æ¿/æ‰‹æ©Ÿ)
  - âœ… æ¸¬è©¦ ARIA å¯è¨ªå•æ€§æ¨™ç±¤
  - âœ… npm scripts: `test:e2e:chrome`, `test:e2e:firefox`, `test:e2e:safari`, `test:e2e:all`
- [x] **Task 8.4**: å¯è¨ªå•æ€§æª¢æŸ¥ âœ… - 2025-12-15
  - âœ… çµ±è¨ˆå¡ç‰‡æ·»åŠ  ARIA æ¨™ç±¤
  - âœ… åœ–è¡¨å…ƒä»¶æ·»åŠ  role="img" å’Œ aria-label
  - âœ… æ™‚é–“é¸æ“‡å™¨æ·»åŠ  radiogroup å’Œ aria-pressed
  - âœ… è¼‰å…¥/éŒ¯èª¤ç‹€æ…‹æ·»åŠ  aria-busy å’Œ role="alert"

---

### Task 9: æ–‡ä»¶èˆ‡äº¤ä»˜

**ç¸½é«”å®Œæˆåº¦ï¼š100% - 2025-12-15 å®Œæˆ**

- [x] **Task 9.1**: æ›´æ–° API æ–‡ä»¶ âœ…
  - å»ºç«‹ OpenAPI 3.0 è¦ç¯„ (`docs/api/openapi.yaml`)
  - æ¶µè“‹æ‰€æœ‰ API ç«¯é»
  - åŒ…å«è³‡æ–™çµæ§‹å®šç¾©
- [x] **Task 9.2**: å‰ç«¯çµ„ä»¶æ–‡ä»¶ âœ…
  - ä»£ç¢¼è¨»è§£æ¸…æ™°
  - Story æ–‡ä»¶å®Œæ•´

---

## Definition of Done (æª¢æŸ¥æ¸…å–®)

**æ ¸å¿ƒåŠŸèƒ½ï¼š**

- [x] æ‰€æœ‰æ ¸å¿ƒ AC å·²å¯¦ä½œ (AC 1, 2, 3, 4, 6, 7) âœ…
- [x] âœ… AC 2 (æ™‚é–“ç¯„åœé¸æ“‡å™¨) å·²å¯¦ä½œ - 2025-12-15
- [ ] âš ï¸ AC 5 (ç‰©åŒ–è¦–åœ–) å»¶å¾Œè‡³ Story 2.4 å¯¦ä½œ

**ä»£ç¢¼å“è³ªï¼š**

- [x] å¾Œç«¯å–®å…ƒæ¸¬è©¦é€šéç‡ 100% (76 å€‹æ¸¬è©¦) âœ…
- [x] å‰ç«¯çµ„ä»¶æ¸¬è©¦é€šéç‡ 100% (121 å€‹æ¸¬è©¦) âœ…
- [x] E2E æ¸¬è©¦æ¶µè“‹æ ¸å¿ƒæµç¨‹ (4 å€‹æ¸¬è©¦) âœ…
- [x] ç„¡ ESLint éŒ¯èª¤ âœ…
- [x] ç„¡ TypeScript é¡å‹éŒ¯èª¤ âœ…

**æ•ˆèƒ½èˆ‡åŠŸèƒ½ï¼š**

- [x] API æŸ¥è©¢æ€§èƒ½ <100ms âœ… (Mock data)
- [x] API æ•ˆèƒ½ç›£æ§å·²å¯¦ä½œ âœ… - 2025-12-15
- [x] åœ–è¡¨åœ¨ Chrome ä¸Šæ¸²æŸ“æ­£ç¢º âœ…
- [x] è·¨ç€è¦½å™¨æ¸¬è©¦å·²é…ç½® (Firefox/Safari) âœ… - 2025-12-15

**äº¤ä»˜ï¼š**

- [x] ç¨‹å¼ç¢¼å·²æäº¤è‡³ git âœ…
- [x] Story æ¨™è¨˜ç‚º Completed âœ…
- [x] âœ… API æ–‡ä»¶å·²å»ºç«‹ (OpenAPI 3.0) - 2025-12-15

---

## ç¸½çµ

**âœ… Story 2.2 å·²å®Œæ•´äº¤ä»˜**

**å®Œæˆé …ç›®ï¼š**

- âœ… Viewer Dashboard å®Œæ•´å¯¦ä½œ
- âœ… Channel Detail Page with Recharts
- âœ… æ™‚é–“ç¯„åœé¸æ“‡å™¨ (7/30/90 å¤© + è‡ªè¨‚æ—¥æœŸ)
- âœ… 7 å€‹çµ±è¨ˆæŒ‡æ¨™å¡ç‰‡
- âœ… API ç«¯é»èˆ‡ Mock Data Seeding
- âœ… startDate/endDate åƒæ•¸æ”¯æ´ (AC 4 å®Œæ•´å¯¦ä½œ)
- âœ… é ­åƒ Proxy API
- âœ… OpenAPI 3.0 æ–‡æª”
- âœ… ARIA å¯è¨ªå•æ€§ (a11y) å®Œæ•´æ”¯æ´
- âœ… API æ•ˆèƒ½ç›£æ§ (`/api/admin/performance/*`)
- âœ… è·¨ç€è¦½å™¨æ¸¬è©¦é…ç½® (Chrome/Firefox/Safari)
- âœ… å…¨é¢æ¸¬è©¦è¦†è“‹ (197 tests: 76 å¾Œç«¯ + 121 å‰ç«¯)
- âœ… éŒ¯èª¤è™•ç†èˆ‡æˆæ¬Šæª¢æŸ¥

**æœªå®Œæˆ / Technical Debtï¼š**

- âš ï¸ ç‰©åŒ–è¦–åœ–èšåˆ (AC 5) - **å»¶å¾Œè‡³ Story 2.4 å¯¦ä½œ**

**å»ºè­°ï¼š**

1. ç•¶è³‡æ–™é‡è¶…é 10 è¬ç­†æ™‚è€ƒæ…®å¯¦ä½œç‰©åŒ–è¦–åœ–
2. ç”Ÿç”¢éƒ¨ç½²å‰åŸ·è¡Œè·¨ç€è¦½å™¨ E2E æ¸¬è©¦
3. ç¹¼çºŒå¯¦ä½œ Story 2.3 (èŠå¤©èˆ‡äº’å‹•çµ±è¨ˆ)

**æ•´é«”è©•åƒ¹ï¼š** ğŸŸ¢ **å®Œæ•´äº¤ä»˜** (æ ¸å¿ƒåŠŸèƒ½å…¨éƒ¨å¯¦ç¾ï¼ŒæŠ€è¡“å‚µå‹™å·²æ¸…ç†)
