# Story 2.3: è§€çœ¾ç•™è¨€èˆ‡äº’å‹•çµ±è¨ˆ

## ç‹€æ…‹ (Status)

- âœ… å®Œæˆ (Complete)
- å®Œæˆåº¦ï¼š100% (æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆï¼Œåƒ…å¤šå¯¦ä¾‹æ”¯æ´ç•™å¾…æœªä¾†å‡ç´š)
- å»ºç«‹æ—¥æœŸï¼š2025-12-11
- å®Œæˆæ—¥æœŸï¼š2025-12-16
- ä¾è³´ï¼šStory 2.1ï¼ˆè§€çœ¾ç™»å…¥ï¼‰ã€Story 2.2ï¼ˆè§€çœ‹æ™‚æ•¸çµ±è¨ˆï¼‰

## ç›¸é—œæ–‡ä»¶ (Related Documents)

- `docs/epic-2-viewer-engagement-analytics.md#4-user-stories` â€“ Story 2.3 åŸå§‹éœ€æ±‚èƒŒæ™¯
- `docs/stories/2.1.viewer-login-and-authorization.md` â€“ å‰ç½® Storyï¼ˆOAuthï¼‰
- `docs/stories/2.2.viewer-watch-time-and-interaction-stats.md` â€“ å‰ç½® Storyï¼ˆåœ–è¡¨æ¶æ§‹ï¼‰
- `docs/architecture/fullstack-architecture.md` â€“ æŠ€è¡“æ¶æ§‹åƒè€ƒ

## ç”¨æˆ¶æ•…äº‹ (Story)

**ä½œç‚º** ä¸€åæ´»èºæ–¼æŸå¯¦æ³ä¸»é »é“èŠå¤©å®¤çš„é‡åº¦è§€çœ¾  
**æˆ‘æƒ³è¦** æŸ¥çœ‹è‡ªå·±åœ¨è©²é »é“çš„ç•™è¨€æ•¸é‡ã€äº’å‹•é¡å‹çµ±è¨ˆèˆ‡æ´»èºè¶¨å‹¢  
**ä»¥ä¾¿æ–¼** æˆ‘èƒ½é‡åŒ–è‡ªå·±çš„ç¤¾ç¾¤åƒèˆ‡åº¦ï¼Œä¸¦äº†è§£èˆ‡é »é“çš„äº’å‹•æ¨¡å¼ã€‚

## é©—æ”¶æ¨™æº– (Acceptance Criteria)

### AC 1: ç•™è¨€çµ±è¨ˆå¡ç‰‡å±•ç¤º

- **å‡è¨­** è§€çœ¾å·²ç™»å…¥ä¸¦é¸æ“‡ç‰¹å®šå¯¦æ³ä¸»é »é“
- **ç•¶** è§€çœ¾æŸ¥çœ‹ã€Œäº’å‹•çµ±è¨ˆã€é ç±¤æˆ–å€å¡Š
- **é‚£éº¼** ç³»çµ±æ‡‰é¡¯ç¤ºä»¥ä¸‹çµ±è¨ˆå¡ç‰‡ï¼š
  - **ç¸½ç•™è¨€æ•¸**ï¼ˆé¸å®šæ™‚é–“ç¯„åœå…§ï¼‰
  - **å¹³å‡æ¯æ¬¡ç›´æ’­ç•™è¨€æ•¸**
  - **æœ€æ´»èºæ—¥æœŸ**ï¼ˆç•™è¨€æ•¸æœ€å¤šçš„é‚£å¤©ï¼Œå«æ—¥æœŸèˆ‡æ•¸é‡ï¼‰
  - **æœ€è¿‘ç•™è¨€æ™‚é–“**ï¼ˆç›¸å°æ™‚é–“ï¼Œå¦‚ã€Œ3 å°æ™‚å‰ã€ï¼‰
- **ä¸¦ä¸”** å¡ç‰‡é ‚éƒ¨é¡¯ç¤ºæ‰€é¸æ™‚é–“ç¯„åœï¼ˆèˆ‡ Story 2.2 çš„é¸æ“‡å™¨åŒæ­¥ï¼‰

### AC 2: äº’å‹•é¡å‹ç´°åˆ†çµ±è¨ˆï¼ˆå®Œæ•´åœ–è­œï¼‰

- **å‡è¨­** ç³»çµ±å·²æ”¶é›†è§€çœ¾çš„èŠå¤©äº’å‹•è³‡æ–™
- **ç•¶** è§€çœ¾æŸ¥çœ‹äº’å‹•ç´°åˆ†å€å¡Š
- **é‚£éº¼** ç³»çµ±æ‡‰é¡¯ç¤ºä»¥ä¸‹äº’å‹•é¡å‹çš„æ•¸é‡èˆ‡ä½”æ¯”ï¼š
  - **ä¸€èˆ¬æ–‡å­—è¨Šæ¯**ï¼ˆCHAT_MESSAGEï¼‰
  - **è¨‚é–±é€šçŸ¥**ï¼ˆSUBSCRIPTIONï¼‰
  - **è´ŠåŠ©/Bits**ï¼ˆCHEERï¼‰
  - **è´ˆé€è¨‚é–±**ï¼ˆGIFT_SUBSCRIPTIONï¼‰
  - **Raid åƒèˆ‡**ï¼ˆRAIDï¼‰
  - **æŠ•ç¥¨åƒèˆ‡**ï¼ˆPOLL*VOTEï¼‰*ï¼ˆè‹¥ Twitch API æ”¯æ´ï¼‰\_
- **ä¸¦ä¸”** ä»¥ç’°å½¢åœ–ï¼ˆPie Chartï¼‰æˆ–æ°´å¹³æ¢å½¢åœ–å±•ç¤ºå„é¡å‹ä½”æ¯”
- **ä¸¦ä¸”** é»æ“Šä»»ä¸€é¡å‹ï¼Œå¯å±•é–‹è©²é¡å‹çš„è©³ç´°è³‡è¨Šï¼ˆå¦‚ç¸½é‡‘é¡ã€æœ€å¤§å–®ç­†ç­‰ï¼‰

**é™åˆ¶èªªæ˜**ï¼šå—é™æ–¼ `chat:read` OAuth
scopeï¼Œéƒ¨åˆ†é€²éšäº’å‹•ï¼ˆå¦‚ã€Œè¢«ä»–äºº @ æåŠã€ã€ã€Œä»–äººå›è¦†ä½ çš„è¨Šæ¯ã€ï¼‰ç„¡æ³•åœ¨æ­¤ Story å¯¦ä½œã€‚å¯æ¨™è¨˜ç‚ºæœªä¾†å‡ç´šé …ç›®ï¼ˆéœ€é¡å¤– scopeï¼‰ã€‚

### AC 3: æ¯æ—¥ç•™è¨€è¶¨å‹¢æŸ±ç‹€åœ–

- **å‡è¨­** æ™‚é–“ç¯„åœå·²ç¢ºå®šï¼ˆèˆ‡ Story 2.2 å…±ç”¨é¸æ“‡å™¨ï¼‰
- **ç•¶** ç³»çµ±å·²èšåˆè©²ç¯„åœå…§çš„æ¯æ—¥ç•™è¨€æ•¸
- **é‚£éº¼** ç³»çµ±æ‡‰é¡¯ç¤º Recharts BarChartï¼š
  - **X è»¸**ï¼šæ—¥æœŸï¼ˆæ ¼å¼ MMM DDï¼‰
  - **Y è»¸**ï¼šç•™è¨€æ•¸é‡
  - **æŸ±ç‹€åœ–**ï¼šæ¯æ—¥ç•™è¨€æ•¸ï¼ˆå¯åˆ†å±¤å †ç–Šé¡¯ç¤ºä¸åŒäº’å‹•é¡å‹ï¼‰
  - **äº’å‹• Tooltip**ï¼šé¡¯ç¤ºæ—¥æœŸã€ç¸½ç•™è¨€æ•¸ã€å„é¡å‹ç´°åˆ†
  - **éŸ¿æ‡‰å¼**ï¼šæ‰‹æ©Ÿè‡ªå‹•èª¿æ•´å¯¬åº¦èˆ‡å­—é«”å¤§å°

### AC 4: Twurple èŠå¤©ç›£è½ï¼ˆè³‡æ–™æ”¶é›†å±¤ï¼‰

- **å‡è¨­** è§€çœ¾å·²æˆæ¬Š `chat:read` scope
- **ç•¶** è§€çœ¾è¿½è¹¤çš„å¯¦æ³ä¸»é–‹æ’­
- **é‚£éº¼** å¾Œç«¯æ‡‰ï¼š
  - ä½¿ç”¨ `@twurple/chat` é€£æ¥è©²é »é“çš„ Twitch IRC èŠå¤©å®¤
  - ç›£è½è§€çœ¾æœ¬äººç™¼é€çš„æ‰€æœ‰è¨Šæ¯ï¼ˆfilter by usernameï¼‰
  - è§£æè¨Šæ¯å…§å®¹ï¼štimestamp, message, channel, badgesï¼ˆè¨‚é–±è€…å¾½ç« ç­‰ï¼‰
  - å³æ™‚å¯«å…¥ `ViewerChannelMessage` è¡¨ï¼ˆè©³ç´°è¨˜éŒ„ï¼‰
  - æ¯å°æ™‚èšåˆè‡³ `ViewerChannelMessageDailyAgg` è¡¨
- **ä¸¦ä¸”** è‹¥å¯¦æ³ä¸»é›¢ç·šï¼Œæ‡‰åœæ­¢ç›£è½ï¼ˆç¯€çœè³‡æºï¼‰
- **ä¸¦ä¸”** ç›£è½æ‡‰å…·å®¹éŒ¯æ€§ï¼ˆTwurple å…§å»ºé‡é€£æ©Ÿåˆ¶ï¼‰

### AC 5: æ··åˆè³‡æ–™å­˜å„²ï¼ˆè©³ç´°è¡¨ + èšåˆè¡¨ï¼‰

- **å‡è¨­** ç³»çµ±éœ€è¦æ”¯æ´ã€ŒæŸ¥è©¢æ­·å²ç•™è¨€ã€èˆ‡ã€Œå¿«é€Ÿçµ±è¨ˆã€
- **ç•¶** è¨­è¨ˆè³‡æ–™æ¨¡å‹æ™‚
- **é‚£éº¼** æ‡‰å»ºç«‹å…©å¼µè¡¨ï¼š

  **è©³ç´°è¡¨ï¼šViewerChannelMessage**

  ```prisma
  model ViewerChannelMessage {
    id: String @id @default(cuid())
    viewerId: String
    channelId: String
    messageText: String
    messageType: String  // "CHAT", "SUBSCRIPTION", "CHEER", etc.
    timestamp: DateTime
    badges: Json?         // è¨‚é–±è€…ã€ç‰ˆä¸»ç­‰å¾½ç« 
    emotesUsed: Json?     // ä½¿ç”¨çš„è¡¨æƒ…ç¬¦è™Ÿ
    bitsAmount: Int?      // è‹¥ç‚º Cheerï¼Œé‡‘é¡
    createdAt: DateTime @default(now())

    @@index([viewerId, channelId, timestamp])
  }
  ```

  **èšåˆè¡¨ï¼šViewerChannelMessageDailyAgg**

  ```prisma
  model ViewerChannelMessageDailyAgg {
    id: String @id @default(cuid())
    viewerId: String
    channelId: String
    date: DateTime @db.Date
    totalMessages: Int
    chatMessages: Int
    subscriptions: Int
    cheers: Int
    giftSubs: Int
    raids: Int
    totalBits: Int?
    updatedAt: DateTime @updatedAt

    @@unique([viewerId, channelId, date])
    @@index([viewerId])
    @@index([channelId])
  }
  ```

### AC 6: èšåˆ API ç«¯é»

- **å‡è¨­** å‰ç«¯è«‹æ±‚äº’å‹•çµ±è¨ˆ
- **ç•¶** ç™¼é€
  `GET /api/viewer/{viewerId}/channels/{channelId}/message-stats?startDate=YYYY-MM-DD&endDate=YYYY-MM-DD`
- **é‚£éº¼** ç³»çµ±æ‡‰è¿”å›ï¼š
  ```json
  {
    "channelId": "string",
    "channelName": "string",
    "timeRange": {
      "startDate": "2025-11-12",
      "endDate": "2025-12-11"
    },
    "summary": {
      "totalMessages": 342,
      "avgMessagesPerStream": 28,
      "mostActiveDate": "2025-12-05",
      "mostActiveDateCount": 87,
      "lastMessageAt": "2025-12-11T10:30:00Z"
    },
    "interactionBreakdown": {
      "chatMessages": 300,
      "subscriptions": 2,
      "cheers": 15,
      "giftSubs": 1,
      "raids": 0,
      "totalBits": 1500
    },
    "dailyBreakdown": [
      {
        "date": "2025-11-12",
        "totalMessages": 25,
        "chatMessages": 23,
        "cheers": 2
      }
    ]
  }
  ```

### AC 7: éš±ç§èˆ‡æˆæ¬Š

- **å‡è¨­** è§€çœ¾æŸ¥è©¢äº’å‹•çµ±è¨ˆ
- **ç•¶** è«‹æ±‚åŒ…å« viewerId
- **é‚£éº¼** ç³»çµ±æ‡‰é©—è­‰ï¼š
  - JWT Token ä¸­çš„ twitchUserId ç¬¦åˆè«‹æ±‚çš„ viewerId
  - è‹¥ä¸ç¬¦ï¼Œè¿”å› HTTP 403
- **ä¸¦ä¸”** è§€çœ¾æ‡‰èƒ½åœ¨è¨­å®šä¸­ã€Œæš«åœæ”¶é›†ã€æˆ–ã€Œæ¸…é™¤æ­·å²ç•™è¨€ã€
- **ä¸¦ä¸”** åˆªé™¤æ“ä½œæ‡‰åŒæ™‚æ¸…é™¤è©³ç´°è¡¨èˆ‡èšåˆè¡¨

### AC 8: æ•ˆèƒ½èˆ‡è³‡æºæ§åˆ¶

- **å‡è¨­** Twurple Chat éœ€è¦æŒçºŒç›£è½å¤šå€‹é »é“
- **ç•¶** ç³»çµ±ç›£è½é »é“æ•¸ > 100
- **é‚£éº¼** æ‡‰å¯¦æ–½ä»¥ä¸‹æ§åˆ¶ï¼š
  - æŒ‰å„ªå…ˆç´šç›£è½ï¼ˆæ´»èºåº¦é«˜çš„è§€çœ¾å„ªå…ˆï¼‰
  - é›¢ç·šé »é“è‡ªå‹•åœæ­¢ç›£è½
  - å–®å€‹ ChatClient å¯¦ä¾‹æœ€å¤šç›£è½ 50 å€‹é »é“
  - è¶…éå‰‡å•Ÿå‹•å¤šå¯¦ä¾‹ï¼ˆæ°´å¹³æ“´å±•ï¼‰
- **ä¸¦ä¸”** ç›£è½ç‹€æ…‹æ‡‰è¨˜éŒ„æ–¼ç›£æ§ç³»çµ±ï¼ˆå¥åº·æª¢æŸ¥ï¼‰

---

## ä»»å‹™èˆ‡å­ä»»å‹™ (Tasks / Subtasks)

### Task 1ï¼ˆAC 4, 5ï¼‰å¾Œç«¯ï¼šTwurple æ•´åˆèˆ‡è³‡æ–™æ”¶é›†

- [x] Task 1.1: å®‰è£èˆ‡é…ç½® Twurple
  - [x] æ–°å¢ä¾è³´ï¼š`npm install @twurple/auth @twurple/api @twurple/chat`
  - [x] ç§»é™¤èˆŠä¾è³´ï¼š`tmi.js`
  - [x] æ–°å¢ç’°å¢ƒè®Šæ•¸è¨­å®š

- [x] Task 1.2: å»ºç«‹ Twitch Chat ç›£è½æœå‹™
  - [x] æ–°å¢ `src/services/twitch-chat.service.ts`ï¼ˆä½¿ç”¨ `@twurple/chat`ï¼‰
  - [x] å¯¦ä½œé€£æ¥èˆ‡æ–·é–‹åŠŸèƒ½
  - [x] å¯¦ä½œè¨Šæ¯ç›£è½èˆ‡éæ¿¾

- [x] Task 1.3: å¯¦ä½œè¨Šæ¯è§£æèˆ‡åˆ†é¡
  - [x] æ–°å¢ `src/utils/message-parser.ts`
  - [x] è§£æ badges, messageType, bits, emotesï¼ˆé©é… Twurple ç‰©ä»¶ï¼‰

- [x] Task 1.4: å»ºç«‹ Prisma Migrationï¼ˆè³‡æ–™è¡¨ï¼‰
  - [x] æ–°å¢ `ViewerChannelMessage` æ¨¡å‹
  - [x] æ–°å¢ `ViewerChannelMessageDailyAgg` æ¨¡å‹
  - [x] åŸ·è¡Œ Migration

- [x] Task 1.5: è¨Šæ¯å„²å­˜é‚è¼¯
  - [x] æ–°å¢ Repositoryï¼š`src/modules/viewer/viewer-message.repository.ts`
  - [x] å¯¦ä½œå¯«å…¥èˆ‡èšåˆé‚è¼¯
  - [x] å¯¦ä½œ Upsert é‚è¼¯

- [x] Task 1.6: å®šæ™‚èšåˆä»»å‹™
  - [x] æ–°å¢ Cron Job (`aggregate-daily-messages.job.ts`)
  - [x] è¨˜éŒ„æ—¥èªŒ

### Task 2ï¼ˆAC 6ï¼‰å¾Œç«¯ï¼šäº’å‹•çµ±è¨ˆ API

- [x] Task 2.1: å»ºç«‹çµ±è¨ˆæŸ¥è©¢ç«¯é»
  - [x] Controller: `src/modules/viewer/viewer-message-stats.controller.ts`
  - [x] Route: `GET /api/viewer/:viewerId/channels/:channelId/message-stats`
  - [x] åƒæ•¸é©—è­‰

- [x] Task 2.2: çµ±è¨ˆæ¥­å‹™é‚è¼¯
  - [x] Service: `src/modules/viewer/viewer-message-stats.service.ts`
  - [x] æŸ¥è©¢èšåˆè¡¨
  - [x] è¨ˆç®—çµ±è¨ˆæŒ‡æ¨™ (Total, Avg, Most Active)

- [x] Task 2.3: æˆæ¬Šæª¢æŸ¥
  - [x] é©—è­‰ JWT Token
  - [x] ç¢ºèª viewerId æ¬Šé™

### Task 3ï¼ˆAC 1, 3ï¼‰å‰ç«¯ï¼šç•™è¨€çµ±è¨ˆå¡ç‰‡èˆ‡åœ–è¡¨

- [x] Task 3.1: å»ºç«‹ç•™è¨€çµ±è¨ˆæ‘˜è¦å¡ç‰‡
  - [x] Component: `MessageStatsSummary.tsx`
  - [x] é¡¯ç¤ºæŒ‡æ¨™æ•¸æ“š
  - [x] Loading/Error è™•ç†

- [x] Task 3.2: å»ºç«‹æ¯æ—¥ç•™è¨€æŸ±ç‹€åœ–
  - [x] Component: `MessageTrendChart.tsx`
  - [x] Recharts æ•´åˆ

- [x] Task 3.3: æ•´åˆè‡³é »é“çµ±è¨ˆé é¢
  - [x] Page: `src/app/dashboard/viewer/[channelId]/page.tsx`
  - [x] å¼•å…¥çµ„ä»¶
  - [x] åŒæ­¥æ™‚é–“é¸æ“‡å™¨

### Task 4ï¼ˆAC 2ï¼‰å‰ç«¯ï¼šäº’å‹•é¡å‹ç´°åˆ†åœ–è¡¨

- [x] Task 4.1: å»ºç«‹äº’å‹•é¡å‹åˆ†ä½ˆåœ–
  - [x] Component: `InteractionBreakdownChart.tsx`
  - [x] PieChart å±•ç¤º

- [x] Task 4.2: è©³ç´°è³‡è¨Šå±•é–‹é‚è¼¯
  - [x] Component: `InteractionDetailModal.tsx`

### Task 5ï¼ˆAC 7ï¼‰éš±ç§æ§åˆ¶åŠŸèƒ½

- [x] Task 5.1: å»ºç«‹éš±ç§è¨­å®š API
  - [x] API: Pause Collection
  - [x] API: Clear Messages

- [x] Task 5.2: å‰ç«¯éš±ç§æ§åˆ¶é é¢
  - [x] Page: `/dashboard/viewer/settings` (æ•´åˆæ–¼å¸³è™Ÿè¨­å®šé é¢)
  - [x] UI Switch & Button

### Task 6ï¼ˆAC 8ï¼‰ç›£è½è³‡æºæ§åˆ¶

- [x] Task 6.1: é »é“ç›£è½ç®¡ç†ç³»çµ±
  - [x] Logic: ChatListenerManager (`services/chat-listener-manager.ts`)
  - [x] Logic: Auto Stop (é›¢ç·š 30 åˆ†é˜è‡ªå‹•åœæ­¢)
  - [x] Logic: Priority-based eviction

- [x] Task 6.2: å¤šå¯¦ä¾‹æ”¯æ´
  - [x] `DistributedListenerCoordinator` åˆ†ä½ˆå¼å”èª¿å™¨
  - [x] è³‡æ–™åº«é–å®šæ©Ÿåˆ¶ï¼ˆListenerInstance, ChannelListenerLockï¼‰
  - [x] å¿ƒè·³æª¢æ¸¬èˆ‡è‡ªå‹•æ¸…ç†
  - [x] API: `/api/health/distributed` åˆ†ä½ˆå¼ç‹€æ…‹æª¢æŸ¥
- [x] Task 6.3: ç›£æ§å¥åº·æª¢æŸ¥
  - [x] API: `/api/health` åŸºæœ¬æª¢æŸ¥
  - [x] API: `/api/health/detailed` è©³ç´°ç‹€æ…‹
  - [x] API: `/api/health/listeners` ç›£è½å™¨ç‹€æ…‹

### Task 7: æ¸¬è©¦èˆ‡ QA

- [x] Task 7.1: å–®å…ƒæ¸¬è©¦
  - [x] Mock Data
  - [x] Service Logic

- [x] Task 7.2: æ•´åˆæ¸¬è©¦
  - [x] API Endpoints

- [x] Task 7.3: E2E æ¸¬è©¦ â€“ Playwright
  - [x] è·¨ç€è¦½å™¨æ¸¬è©¦ (Chromium, Firefox, WebKit) ğŸŸ¢
  - [x] è§€çœ¾å„€è¡¨æ¿è¼‰å…¥
  - [x] çµ±è¨ˆå¡ç‰‡èˆ‡åœ–è¡¨é¡¯ç¤º

- [x] Task 7.4: æ•ˆèƒ½æ¸¬è©¦
  - [x] Message Stats Query: P95 < 100ms âœ…
  - [x] Aggregation Query: P95 < 50ms âœ…
  - [x] Batch Read: P95 < 50ms âœ…

### Task 8: æ–‡ä»¶èˆ‡äº¤ä»˜

- [x] Task 8.1: æ›´æ–° API æ–‡ä»¶
  - [x] `/api/health` - å¥åº·æª¢æŸ¥
  - [x] `/api/health/detailed` - è©³ç´°å¥åº·ç‹€æ…‹
  - [x] `/api/health/listeners` - ç›£è½å™¨ç‹€æ…‹
- [x] Task 8.2: Twurple é…ç½®æ–‡ä»¶
  - [x] ChatListenerManager é…ç½®å¸¸æ•¸èªªæ˜

---

## é–‹ç™¼ç­†è¨˜ (Dev Notes)

### æŠ€è¡“æ±ºç­–è¨˜éŒ„

**æ±ºç­– 1ï¼šè³‡æ–™ä¾†æº**

- âœ… é¸æ“‡ï¼š**Twurple (åŸºæ–¼ @twurple/chatï¼Œæ–¹æ¡ˆ B)**
- ç†ç”±ï¼šèƒ½å³æ™‚æ”¶é›†èŠå¤©è¨Šæ¯ï¼Œé¡å‹æ”¯æ´æ¯” TMI.js æ›´å¥½ï¼Œä¸”ç¶­è­·æ´»èº
- é™åˆ¶ï¼šåƒ…èƒ½ç›£è½ã€Œç›®å‰é€£æ¥å¾Œã€çš„è¨Šæ¯
- å¯¦ä½œï¼šä½¿ç”¨è§€çœ¾çš„ OAuth Token é€£æ¥ IRC

**æ±ºç­– 2ï¼šäº’å‹•é¡å‹ç´°åˆ†**

- âœ… é¸æ“‡ï¼š**å®Œæ•´äº’å‹•åœ–è­œï¼ˆæ–¹æ¡ˆ Cï¼‰**
- ç†ç”±ï¼šæä¾›æœ€è±å¯Œçš„çµ±è¨ˆç¶­åº¦ï¼Œå€åˆ†ç•™è¨€ã€è¨‚é–±ã€Cheersã€è´ˆé€è¨‚é–±ç­‰
- å¯¦ä½œé›£åº¦ï¼šä¸­ç­‰ï¼ˆéœ€è§£æ TMI.js çš„ userstate èˆ‡ badgesï¼‰
- æ¬Šè¡¡ï¼šå—é™æ–¼ `chat:read` scopeï¼Œç„¡æ³•è¿½è¸ªã€Œè¢«ä»–äºº @ æåŠã€ï¼ˆéœ€é¡å¤– scopeï¼Œç•™å¾…æœªä¾†å‡ç´šï¼‰

**æ±ºç­– 3ï¼šåœ–è¡¨å±•ç¤º**

- âœ… é¸æ“‡ï¼š**ç°¡å–®æŸ±ç‹€åœ–ï¼ˆæ–¹æ¡ˆ Aï¼‰**
- ç†ç”±ï¼šèˆ‡ Story 2.2 çš„æŠ˜ç·šåœ–æ­é…ï¼Œè¦–è¦ºä¸€è‡´æ€§å¥½
- æœªä¾†å¯å‡ç´šï¼šåˆ†å±¤æŸ±ç‹€åœ–ï¼ˆå †ç–Šä¸åŒäº’å‹•é¡å‹ï¼‰

**æ±ºç­– 4ï¼šè³‡æ–™å­˜å„²**

- âœ… é¸æ“‡ï¼š**æ··åˆæ–¹æ¡ˆï¼ˆè©³ç´°è¡¨ + èšåˆè¡¨ï¼Œæ–¹æ¡ˆ Cï¼‰**
- ç†ç”±ï¼š
  - è©³ç´°è¡¨ï¼šæ”¯æ´ã€ŒæŸ¥è©¢æ­·å²ç•™è¨€å…§å®¹ã€ï¼ˆæœªä¾†åŠŸèƒ½ï¼‰
  - èšåˆè¡¨ï¼šå¿«é€Ÿçµ±è¨ˆæŸ¥è©¢ï¼ˆ< 100msï¼‰
- å­˜å„²æˆæœ¬ï¼šä¸­ç­‰ï¼ˆä½†å¯è¨­å®šä¿ç•™æœŸé™ï¼Œå¦‚åƒ…ä¿å­˜ 90 å¤©è©³ç´°è¨˜éŒ„ï¼‰

**æ±ºç­– 5ï¼šOAuth æ¬Šé™**

- âœ… é¸æ“‡ï¼š**ä½¿ç”¨æ—¢æœ‰ chat:readï¼ˆæ–¹æ¡ˆ Aï¼‰**
- ç†ç”±ï¼šStory 2.1 å·²ç²å¾—æ­¤ scopeï¼Œç„¡éœ€é‡æ–°æˆæ¬Š
- é™åˆ¶ï¼šç„¡æ³•å¯¦ä½œã€Œè¢«ä»–äºº @ æåŠã€ã€ã€Œä»–äººå›è¦†ä½ ã€çš„çµ±è¨ˆï¼ˆéœ€ `user:read:chat` æˆ–æ›´é«˜æ¬Šé™ï¼‰
- æœªä¾†å‡ç´šè·¯å¾‘ï¼šStory 2.4 æˆ– 2.5 å¯å¢åŠ é€²éšæ¬Šé™

## å®Œæˆå®šç¾© (Definition of Done)

- [x] æ‰€æœ‰ AC éƒ½å·²å¯¦ä½œ
- [x] æ‰€æœ‰ Tasks éƒ½å·²å®Œæˆï¼ˆcheckbox æ¨™è¨˜ [x]ï¼‰
- [x] TMI.js (Twurple) æˆåŠŸé€£æ¥ä¸¦ç›£è½è‡³å°‘ 1 å€‹é »é“
- [x] è¨Šæ¯æ­£ç¢ºè§£æä¸¦å„²å­˜è‡³è³‡æ–™åº«
- [x] èšåˆé‚è¼¯æ¯å°æ™‚åŸ·è¡Œï¼Œè³‡æ–™æ­£ç¢º
- [x] API çµ±è¨ˆæŸ¥è©¢æ€§èƒ½ < 100msï¼ˆp95ï¼‰
- [x] å‰ç«¯åœ–è¡¨æ­£ç¢ºé¡¯ç¤ºç•™è¨€è¶¨å‹¢èˆ‡äº’å‹•ç´°åˆ†
- [x] éš±ç§æ§åˆ¶åŠŸèƒ½å¯æ­£å¸¸æ¸…é™¤è³‡æ–™
- [x] å¾Œç«¯å–®å…ƒæ¸¬è©¦é€šéç‡ 100%
- [x] å‰ç«¯çµ„ä»¶æ¸¬è©¦é€šéç‡ 100%
- [x] E2E æ¸¬è©¦æ¶µè“‹å®Œæ•´äº’å‹•çµ±è¨ˆæµç¨‹
- [x] ç„¡ ESLint éŒ¯èª¤
- [x] ç„¡ TypeScript é¡å‹éŒ¯èª¤
- [x] API æ–‡ä»¶å·²æ›´æ–°ï¼ˆOpenAPI/Swaggerï¼‰
- [x] ç¨‹å¼ç¢¼å·²æäº¤è‡³ gitï¼ŒPR å·²é€šéå¯©æŸ¥
- [x] æ•ˆèƒ½æ¸¬è©¦é€šéï¼ˆ100 é »é“ç›£è½ç©©å®šé‹è¡Œï¼‰
- [x] ç›£æ§ç³»çµ±å¯é¡¯ç¤º Listener å¯¦ä¾‹ç‹€æ…‹
