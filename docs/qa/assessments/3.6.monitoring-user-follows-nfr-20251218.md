# NFR Assessment: Story 3.6 Monitoring User Follows

**Date:** 2025-12-18 **Assessor:** QA Agent

## Scope

- Security
- Performance
- Reliability
- Maintainability

## Assessment

### 1. Security

- **Requirement**: User data privacy (follows), specific OAuth scope `user:read:follows`.
- **Status**: **PASSED**
- **Notes**:
  - The story correctly identifies the need for `user:read:follows` scope.
  - **Constraint**: Must ensure we handle the case where a user declines this scope or revokes it.
  - **Data Privacy**: Store `UserFollows` relations securely; do not leak one user's follows to
    another unless intended (currently internal logic only).

### 2. Performance

- **Requirement**: Handle potentially thousands of channels; API Rate Limits.
- **Status**: **PASSED**
- **Notes**:
  - The design explicitly mandates usage of Twurple's Batch Get Streams (100 items/req).
  - **Concurrency**: Mentions using `p-limit` (suggested 5-10 clusters). This is a good constraint.
  - **Optimization**: Deduplication of channels before querying is critical and well-noted.

### 3. Reliability

- **Requirement**: Job execution stability, API Quota protection.
- **Status**: **PASSED**
- **Notes**:
  - **Deduplication**: Ensures we don't spam Twitch API for popular channels.
  - **Cleanup**: "Inactive" state logic prevents wasting resources on "dead" channels.
  - **Risk**: If the sync job fails halfway, it should be able to resume or recover next run without
    data corruption (Upsert logic covers this).

### 4. Maintainability

- **Requirement**: Database schema evolution, code clarity.
- **Status**: **PASSED**
- **Notes**:
  - Schema changes are reasonably isolated (`isMonitored`, `UserFollows`).
  - Explicit Tasks for Migration and Cleanup Job.

## Recommendations

- **Testing**: Add a specific test case for the "Rate Limit" scenario using a mock with >100
  channels.
- **Observability**: Log the number of "New Channels Identified" and "Channels Cleaned Up" each run
  for monitoring.
