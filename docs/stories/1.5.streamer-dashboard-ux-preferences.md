# Story 1.5: streamer-dashboard-ux-preferences

## Status

- Draft

## Related Documents

- `docs/prd.md#4-範圍與功能按-epic--story-組織` – Story 1.5 原始需求背景（儀表板 UX / 基礎設定）  
- `docs/epic-1-streamer-analytics-dashboard.md#story-15--儀表板-ux--基礎設定` – Epic 1 整體目標與 Story 1.5 重點  
- `docs/architecture/front-end-architecture.md#3-專案結構設計project-structure` – `store/uiPreferences.ts` 狀態管理位置、設定 UI 與 Drawer 元件結構  
- `docs/front-end-spec.md` – Dark Tech Dashboard 風格、設定 UI 可用性原則與可訪問性要求

## Story

**As a** Twitch 實況主（Streamer）  
**I want** 能在儀表板中簡單調整顯示設定（顯示/隱藏卡片與圖表，儲存偏好）  
**so that** 我能專注在我最在意的指標，並維持自己習慣的儀表板配置。

## Acceptance Criteria

1. **顯示/隱藏卡片與圖表**
   - Given 實況主已登入並進入儀表板  
   - When 實況主進入「顯示設定」或偏好設定區塊  
   - Then 可以透過勾選或切換開關的方式決定哪些 Summary Cards 與圖表要顯示或隱藏，儀表板主畫面會依設定更新。  

2. **偏好設定儲存與還原**
   - Given 實況主已調整顯示設定  
   - When 實況主重新整理頁面、或下次再次登入  
   - Then 系統應還原上次的顯示偏好，而不是回到預設全部顯示。  

3. **新手友善預設配置**
   - Given 實況主第一次登入且尚未有任何偏好設定  
   - When 實況主進入儀表板  
   - Then 系統應採用一組預設的「新手友善」配置（例如顯示核心 3–5 個卡片與主要圖表），而不是完全空白或過度複雜。  

4. **設定區 UX 與可用性**
   - Given 實況主在桌機或手機上調整偏好  
   - When 實況主使用設定 UI  
   - Then 操作應簡單明瞭（清楚標示每個項目代表的圖表/卡片），並符合 `front-end-spec.md` 中的 Dark Tech 風格與可訪問性要求。  

## Tasks / Subtasks

- [ ] Task 1（AC: 1, 2）前端偏好狀態管理
  - [ ] 依 `front-end-architecture.md` 在 `store/uiPreferences.ts` 中實作 `uiPreferencesStore`
  - [ ] 支援以下設定內容（可依初版範圍調整）：  
        - 是否顯示開台 Summary Cards  
        - 是否顯示開台時間序列圖  
        - 是否顯示 Heatmap  
        - 是否顯示訂閱趨勢圖（如已實作 Story 1.4）  
  - [ ] 使用 localStorage（或等效機制）持久化設定

- [ ] Task 2（AC: 1, 4）設定 UI 與儀表板整合
  - [ ] 在 Streamer Dashboard 頁面加入「顯示設定」區（可為摺疊區或側邊 Drawer）
  - [ ] 使用 Checkbox / Toggle Group 等元件列出可控制的圖表與卡片項目
  - [ ] 根據 `uiPreferencesStore` 狀態動態決定哪些區塊要 render

- [ ] Task 3（AC: 2, 3）預設值與初始體驗
  - [ ] 定義一組預設偏好設定（例如全部核心指標皆顯示）
  - [ ] 確保第一次造訪時會載入預設配置，之後才以使用者偏好覆蓋

- [ ] Task 4（AC: 4）可用性與無障礙細節
  - [ ] 設定區中的每個選項需有清楚標籤與輔助說明文字
  - [ ] 支援鍵盤操作（Tab / Space / Enter）切換項目
  - [ ] 顏色並非唯一資訊來源（可搭配 icon 或文字狀態）

## Dev Notes

- 偏好設定目前先以 LocalStorage 為主，未來若要跨裝置同步，可再新增後端儲存機制與相對 Stories。  
- **LocalStorage 使用注意事項**：
  - 建議 key 命名規則：`bmad.streamerDashboard.uiPreferences.v1`（方便未來版本升級）  
  - **不在此處儲存任何敏感資訊**，只存展示偏好（例如：哪些卡片/圖表顯示/隱藏）  
  - 注意：LocalStorage 不同步跨瀏覽器/裝置，此 Story 只保證「同裝置同瀏覽器」的偏好持久化  
- 若與 Viewer 端或其他儀表板共用類似偏好邏輯，可將 store 或設定 UI 做適度抽象。  
- 請嚴格遵守 `docs/front-end-spec.md` 中關於 Dark Tech 視覺、互動與可訪問性的要求。  

### Testing

**測試層級建議：**
- **前端**：Component / Hook 測試 `uiPreferencesStore` 的狀態管理、LocalStorage 持久化與設定 UI 互動邏輯。  
- **端對端**：至少 1 條 **E2E** 路徑驗證完整流程（登入 → 調整設定 → 重新整理 → 確認偏好還原）。

**測試情境：**
- 驗證顯示/隱藏行為：  
  - 勾選/取消部份卡片與圖表後，儀表板實際顯示內容應立即更新。  
- 驗證儲存與還原：  
  - 調整設定後重新整理頁面，或重新登入同一帳號，配置保持不變。  
- 驗證預設體驗：  
  - 新帳號首次登入，顯示預設的新手友善配置，而非空畫面。  
- **跨瀏覽器/裝置差異**：注意 LocalStorage 不同步，此 Story 只保證「同裝置同瀏覽器」的偏好持久化。  

## Change Log

| Date       | Version | Description                                          | Author |
| ---------- | ------- | ---------------------------------------------------- | ------ |
| YYYY-MM-DD | 0.1     | 建立 Story 初稿：儀表板 UX 與顯示偏好設定需求定義    | PO     |

## Dev Agent Record

### Agent Model Used

_由 Dev Agent 於實作時填寫_

### Debug Log References

_由 Dev Agent 於實作時填寫_

### Completion Notes List

_由 Dev Agent 於實作完成時填寫_

### File List

_由 Dev Agent 於實作完成時填寫_

## QA Results

_由 QA Agent 於測試與審查後填寫_


